
<div class="tableViewDiv">
    <div class="modalCurtain" ng-show="tableLoading"></div>
    <div class="modalCurtainDialog" ng-show="tableLoading">
        <img src="assets/default-loader.gif"/>
    </div>
    <div class="row modalHeaderControls">
        <a class="clickableLink" ng-click="closeViewTable()">
            <i class="fa fa-arrow-circle-left"></i>
            Return To Results
        </a>
        <div class="pull-right">
            <!--
            <a class="clickableLink" title="Saving Coming Soon">
                Save To My Account
                <i class="fa fa-cloud"></i>
            </a>
            -->
            <a class="clickableLink" title="Download" ng-click="downloadTable()">
                Download
                <i class="fa fa-download"></i>
            </a>
            <!--
            <a class="clickableLink" title="Sharing Coming Soon">
                Share
                <i class="fa fa-share"></i>
            </a>
            -->
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-12" >
            <h3>
                {{tableTitle}}
            </h3>
            <label>Table:&nbsp;{{tableId}}</label>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-3" >
            <div id="datasetSelectWrapperModal">
                <label  for="datasetSelectModal" id="datasetSelectLabelModal" class="modalHeaderLabels">Dataset</label>
                <select class="tableInstance"
                        id="datasetSelectModal"
                        ng-options="instance as instance.vintage + ': ' + instance.dataset for instance in instances"
                        ng-model="selectedInstance"
                        ng-change="changeDataset(selectedInstance)">
                </select>
                <i class="fa fa-caret-down"></i>
            </div>
        </div>

        <div class="">
            <label class="modalHeaderLabels">View Data As</label>
<!--             <button id="openTableButton" class="btn btn-secondary center-align" >
                  <i class="fa fa-table"></i>
                  Table
             </button>-->
            
              <button id="openMapButton" class="btn btn-secondary center-align"  ng-click="turnThematicMappingOn()">
                  <i class="fa fa-globe"></i>
                  Map
              </button>
<!--              <button id="openChartButton" class="btn btn-secondary center-align" >
                  <i class="fa fa-line-chart"></i>
                  Chart
              </button>-->
            
        </div>
    </div>
    
    <!--
    <div class="row">
        <div class="tableViewPort">

            <div class="row viewTableOptions">

                <div class="pull-left col-md-2 col-lg-2 col-sm-1 link" ng-show="marginOfErrorAvailable">
                    
                    <div class="btn-group tableMarginOfError">
                        <label class="radio-inline ">
                            <input ng-disabled="loadingTable" type="radio"  ng-value="true" ng-model="marginOfError"
                                   ng-change="changeMarginOfError();">
                            On
                        </label>
                        <label class="radio-inline ">
                            <input ng-disabled="loadingTable" type="radio" ng-model="marginOfError" ng-value="false"
                                   ng-change="changeMarginOfError();">
                            Off
                        </label>
                    </div>

                </div>

            </div>

        </div>
    </div>
    -->
    
    <div class="row no-gutter">
        <div ng-show="showFilterDim" class="col-md-2"></div>
        <div ng-class="{'col-md-10': showFilterDim, 'col-md-12': !showFilterDim}" id="tableDisplayTopButtons" >
            <div class="row modalTableTopControls">
                <div class="col-md-6">
                    <a ng-click="transposeTable()" title="Transpose Rows/Columns" id="transposeTableButton" class="clickableLink">
                        <img src="assets/transpose-transparent.png" id="tableDisplayTransposeButton"/>
                    </a>
                    <div id="marginOfErrorConatiner" ng-show="marginOfErrorAvailable">
                        <input id="marginOfErrorCheckbox" ng-disabled="loadingTable" type="checkbox" ng-model="marginOfError" ng-value="true" ng-change="changeMarginOfError();"/>
                        <label for="marginOfErrorCheckbox">Margin of Error: </label>
                    </div>
                    <div id="openGeographiesLinkModal">
                        <a ng-click="openGeographySelectionModal(correspondingSearchResultRow.object)" class="clickableLink">
                            <i class="fa fa-map-marker"></i>
                            Add/Remove Geographies
                        </a>
                    </div>
                    <a ng-show="showFilterButton" ng-click="handleFilterButton()" title="Filter" id="tableDisplayFilterButton" class="clickableLink tableDisplayTableButton">
                        <i class="fa fa-filter"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="row no-gutter">
        <div ng-show="showFilterDim" class="col-md-2">
            <div>
                <filter-dims dims="filterableDims" on-selection="filterSelection(categories)" reset="setResetFilterFn(fn)"></filter-dims>
            </div>
        </div>
        <div ng-class="{'col-md-10': showFilterDim, 'col-md-12': !showFilterDim}" style="min-height: 400px; padding-left: 20px; padding-right: 20px;">

            <div ng-if="showError" style="padding: 1em;">
                <div id="errorMsg" style="text-align: center">
                    <p style="font-weight: bold; color: red; font-size:1.3em; text-align: center; margin-bottom: 1em;">{{errorMessage}}</p>
                    <button class="btn btn-primary center-align" ng-click="tryAgain()">Try again</button>
                    <button class="btn btn-primary center-align" ng-click="closeViewTable()">Exit</button>
                </div>
            </div>

            <div class="row" ng-show="!tableLoading && !showError">

                <div ng-show="thematicMappingMode" class="row thematicMappingInstructions">
                    Select cell of variable to map (
                    <a class="clickableLink viewTableLink" title="" ng-click="turnThematicMappingOff()">Cancel</a>
                    )
                </div>

                <div class="tableViewPort">
                    <table-display
                            content="response.tableViewportContent"
                            on-click="handleThematicMapSelection(cellInfo)"
                            column-info="response.columnInfoById"
                            row-info="response.rowInfoById"
                            select-mode="thematicMappingMode"
                            on-sort="sortTable(sort)"
                            >
                    </table-display>
                </div>
                <div class="row">
                    <div ng-show="showFilterDim" class="col-md-2"></div>
                </div>
                <div class="row">
                    <div class="pagination-buttons col-lg-6">
                        <button class="addFacetButton form-control pagination-button"
                                ng-click="moveUp();"
                                ng-disabled="paginator.isFirstRowPage(currentRowPageNumber)"
                                ng-class="{'btn-primary': !paginator.isFirstRowPage(currentRowPageNumber)}">
                            <i class="fa fa-chevron-up"></i>
                        </button>
                        <button class="addFacetButton form-control pagination-button"
                                ng-click="moveDown();"
                                ng-disabled="paginator.isLastRowPage(currentRowPageNumber)"
                                ng-class="{'btn-primary': !paginator.isLastRowPage(currentRowPageNumber)}">
                            <i class="fa fa-chevron-down"></i>
                        </button>

                        <span>
                            Row {{viewPortConfig.startRow}}
                            to {{viewPortConfig.startRow + viewPortConfig.rowCount - 1}}
                            out of {{totalDataRowCount}}
                        </span>
                    </div>
                    
                    <div class="col-lg-6 pagination-buttons pull-right" >
                        <button class="addFacetButton form-control pagination-button"
                                ng-click="moveLeft();"
                                ng-disabled="paginator.isFirstColumnPage(currentColumnPageNumber)"
                                ng-class="{'btn-primary': !paginator.isFirstColumnPage(currentColumnPageNumber)}"
                                ng-hide="totalDataColumnCount <= numberColumnsDisplayLimit">
                            <i class="fa fa-chevron-left"></i>
                        </button>
                        <button class="addFacetButton form-control pagination-button"
                                ng-click="moveRight();"
                                ng-disabled="paginator.isLastColumnPage(currentColumnPageNumber)"
                                ng-class="{'btn-primary': !paginator.isLastColumnPage(currentColumnPageNumber)}"
                                ng-hide="totalDataColumnCount <= numberColumnsDisplayLimit">
                            <i class="fa fa-chevron-right"></i>
                        </button>

                        <span>
                            Column {{viewPortConfig.startColumn}}
                            to {{viewPortConfig.startColumn + viewPortConfig.columnCount - 1}}
                            out of {{totalDataColumnCount}}
                        </span>
                    </div>
                </div>

            </div>
            <div ng-include="'views/modals/table/tableFootNoteSelection.html'"/>
            <div class="tableNotesDisplay">
                <div ng-show="viewTableNotes" >
                    <h4>Data Notes</h4>
                    <br>
                    <p ng-repeat="headNote in headNotes" ng-bind-html="headNote.propertyContent">
                    </p>

                    <p ng-repeat="layoutHeadNote in layOutHeadNotes" ng-bind-html="layoutHeadNote.propertyContent">
                    </p>
                </div>
                <div ng-show="viewFootNotes">
                    <h4>Foot Notes</h4>
                    <br>
                    <p ng-repeat="footNote in footNotes" ng-bind-html="footNote.propertyContent">
                    </p>

                    <p ng-repeat="layoutFootNote in layOutFootNotes" ng-bind-html="layoutFootNote.propertyContent">
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    
</div>